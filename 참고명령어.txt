
#개수파악
wc -l

#주석 제외
grep -vE '^[[:space:]]*#'
grep -iE '^[[:space:]]*PermitRootLogin' #주석제외하고 PermitRootLogin만 검색


#(( )) 안에서는 c언어의 연산처럼 사용할 수 있다.
((vul++))

#쉘에서 for문 사용법
for i in "${!homes[@]}"; do #본래 배열대신 인덱스번호를 배열로 삽입하여 순회 (( ))로 C언어문법으로 사용하는 것보다 편한 방법


#while로 한줄씩 읽을때에는 IFS=':'와 같이 기준을 통해 분리하여 awk를 쓰지않고 더 빠르게 분리할 수 있다.
while IFS=':' read -r user pw uid gid rest

#awk에 조건 설정 예시
awk -F : '$7=="/bin/bash"{print $1}' /etc/passwd

#[ ]테스트
참인경우
-z 문자열이 비어있을 때
-n 문자열이 존재할 때
-f 파일이 존재할때
-d 디렉터리가 존재할때
-e 파일이든 디렉터리든 존재하면 참
-r 파일이 읽기 가능하면 참
-w 파일이 쓰기 가능하면 참
-x 파일이 실행 가능하면 참
-O 실행 사용자가 소유자이면 참
-G 실행 사용자의 그룹 소유이면 참
-u SUID비트가 설정되어 있으면 참
-g SGID 비트가 설정되어 있으면 참
-k Sticky bit가 설정되어있으면 참
-s 크기가 0보다 크면 참

거짓인 경우
! -?


#grep -q 
quite모드로 출력이 보이지 않는다

#여러개일수있을때 하나만 고르는 명령어
head -n 1

#명령어에서의 논리 실행

command1 && command2 일때 command1이 성공하면 command2를 실행


#서비스 활성화 여부 확인(inetd xinetd systemd)

    checks=() #점검할 서비스 이름
    vulc=0
    for check in "${checks[@]}"; do
        if [ -f /etc/inetd.conf ]; then
                if grep -vE '^[[:space:]]*#' /etc/inetd.conf 2>/dev/null | grep -qE '^[[:space:]]*$check'; then
                    echo "U-44 취약: /etc/inetd.conf 파일에서 $check 서비스가 활성화 되어있음" >> $result
                    ((vulc++))
                fi
        elif [ -d /etc/xinetd.d ]; then
            service_file=$(grep -l "^[[:space:]]*service[[:space:]]*$check" /etc/xinetd.d/* 2>/dev/null | head -n 1)
            if [ -n "$service_file" ]; then
                if ! grep -qi '^[[:space:]]*disable[[:space:]]*=[[:space:]]*yes' "$service_file"; then
                    echo "U-44 취약: $check 서비스가 xinetd에서 활성화 상태임 ($service_file)" >> $result
                    ((vulc++))
                fi
            fi
        elif systemctl list-unit-files 2>/dev/null | grep -qE "$check"; then
            echo "U-44 검토: inetd, xinetd가 없으나 $check 서비스 존재" >> $result
            ((Rev++))
        fi
    done

    if [ $vulc -gt 0 ]; then
        ((Total_vulc++))
    fi